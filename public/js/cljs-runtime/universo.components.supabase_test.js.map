{"version":3,"sources":["universo/components/supabase_test.cljs"],"mappings":"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","names":["universo.components.supabase-test/supabase-test","status","reagent.core.atom","visitor-data","all-visitors","cljs.core/deref","cljs.core/reset!","c__11742__auto__","cljs.core.async.chan","cljs.core.async.impl.dispatch/run","f__11743__auto__","switch__11542__auto__","state_11948","state_val_11949","inst_11938","statearr-11950","inst_11912","inst_11914","statearr-11951","cljs.core.async.impl.ioc-helpers/take!","inst_11917","statearr-11952","inst_11935","inst_11936","statearr-11953","statearr-11954","statearr-11955","inst_11916","inst_11920","inst_11921","inst_11922","inst_11923","inst_11924","inst_11925","inst_11926","cljs.core/PersistentHashMap","inst_11927","statearr-11960","inst_11918","statearr-11962","statearr-11963","statearr-11964","inst_11946","cljs.core.async.impl.ioc-helpers/return-chan","inst_11930","inst_11931","inst_11932","inst_11933","statearr-11965","inst_11942","inst_11943","inst_11944","statearr-11966","statearr-11971","state-machine__11543__auto__","ret-value__11544__auto__","result__11545__auto__","cljs.core/keyword-identical?","ex__11546__auto__","e11972","statearr-11973","cljs.core/seq","statearr-11974","cljs.core/first","state__11744__auto__","statearr-11975","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","js/console.log","universo.ip/fetch-ip-info","universo.db.crud/collect-visitor-data","cljs.core.merge","universo.db.crud/insert-data-table!","state_11991","state_val_11992","inst_11976","inst_11978","inst_11979","statearr-11993","statearr-11994","statearr-11995","inst_11981","inst_11982","inst_11983","statearr-11996","statearr-11997","inst_11985","inst_11986","inst_11987","statearr-11998","inst_11989","statearr-11999","e12000","statearr-12001","statearr-12002","statearr-12003","universo.db.crud/get-all-table","iter__5480__auto__","s__12005","cljs.core/LazySeq","temp__5804__auto__","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__12007","cljs.core/chunk-buffer","i__12006","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__12004","cljs.core/chunk-rest","cljs.core/cons","cljs.core/rest","visitor","cljs.core/chunk-first"],"sourcesContent":["(ns universo.components.supabase-test\n  (:require [reagent.core :as r]\n            [universo.db.crud :as db]\n            [universo.ip :refer [fetch-ip-info]]\n            [cljs.core.async :refer [go <!]]))\n\n(defn supabase-test []\n  (let [status (r/atom \"inicial\")\n        visitor-data (r/atom nil)\n        all-visitors (r/atom [])]\n\n    (fn []\n      [:div\n       [:h2 \"\ud83e\uddea Test de Conexi\u00f3n Supabase\"]\n\n       [:p \"Status: \" @status]\n\n       ;; Bot\u00f3n para insertar datos\n       [:button\n        {:on-click (fn []\n                     (reset! status \"insertando...\")\n                     (go\n                       (js/console.log \"\ud83d\ude80 Iniciando inserci\u00f3n...\")\n\n                       ;; Primero obtener datos de IP\n                       (let [ip-result (<! (fetch-ip-info))\n                             base-data (db/collect-visitor-data)\n\n                             ;; Combinar datos base con datos de IP si est\u00e1n disponibles\n                             final-data (if (:success ip-result)\n                                          (merge base-data\n                                                 {:pais (:country_name (:data ip-result))\n                                                  :ciudad (:city (:data ip-result))})\n                                          base-data)]\n\n                         (js/console.log \"\ud83d\udccb Datos finales a insertar:\" final-data)\n                         (reset! visitor-data final-data)\n\n                         ;; Insertar en Supabase\n                         (let [result (<! (db/insert-data-table! final-data \"visitor\"))]\n                           (if (:success result)\n                             (reset! status \"\u2705 Insertado exitosamente!\")\n                             (reset! status (str \"\u274c Error: \" (:error result))))))))}\n        \"Insertar Visitante\"]\n\n       ;; Bot\u00f3n para obtener todos los datos\n       [:button\n        {:on-click (fn []\n                     (reset! status \"obteniendo datos...\")\n                     (go\n                       (let [result (<! (db/get-all-table \"visitor\"))]\n                         (if (:success result)\n                           (do\n                             (reset! all-visitors (:data result))\n                             (reset! status \"\u2705 Datos obtenidos!\"))\n                           (reset! status (str \"\u274c Error: \" (:error result)))))))}\n        \"Obtener Todos\"]\n\n       ;; Mostrar datos que se van a insertar\n       (when @visitor-data\n         [:div\n          [:h3 \"\ud83d\udccb Datos a insertar:\"]\n          [:ul\n           [:li \"Pa\u00eds: \" (:pais @visitor-data)]\n           [:li \"Ciudad: \" (:ciudad @visitor-data)]\n           [:li \"Timezone: \" (:timezone @visitor-data)]\n           [:li \"Idioma: \" (:idioma @visitor-data)]]])\n\n       ;; Mostrar todos los visitantes\n       (when (seq @all-visitors)\n         [:div\n          [:h3 \"\ud83d\udc65 Visitantes en la BD:\"]\n          [:table {:border \"1\"}\n           [:thead\n            [:tr\n             [:th \"ID\"]\n             [:th \"Fecha\"]\n             [:th \"Pa\u00eds\"]\n             [:th \"Ciudad\"]\n             [:th \"Timezone\"]\n             [:th \"Idioma\"]]]\n           [:tbody\n            (for [visitor @all-visitors]\n              [:tr {:key (:id visitor)}\n               [:td (:id visitor)]\n               [:td (.substring (:created_at visitor) 0 19)]\n               [:td (:pais visitor)]\n               [:td (:ciudad visitor)]\n               [:td (:timezone visitor)]\n               [:td (:idioma visitor)]])]]])])))\n"]}